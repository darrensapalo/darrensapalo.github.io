<!DOCTYPE html>
<html lang="en">
<head>
	<title>Grace dashboard</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Latest compiled and minified CSS -->

	<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
	

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>
	<script src="jquery.rss.min.js"></script>
	<script type="text/javascript">
		function getSearchParameters() {
			var prmstr = window.location.search.substr(1);
			return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
		}

		function transformToAssocArray( prmstr ) {
			var params = {};
			var prmarr = prmstr.split("&");
			for ( var i = 0; i < prmarr.length; i++) {
				var tmparr = prmarr[i].split("=");
				params[tmparr[0]] = tmparr[1];
			}
			return params;
		}

		var params = getSearchParameters();
	</script>

	<style type="text/css">
		.clear {
			margin-top: 1rem;
		}
		img.images {
			height: 150px;
		}
		div.col-md-3 {
			margin-bottom: 4rem;
		}
	</style>
</head>
<body>
	<div class="clear"></div>
	<div class="container">
		<div class="jumbotron">
			<h1>Grace</h1>
			<p>An overview of her Blogspot, Facebook, and Instagram </p>
			<a href="#" class="btn btn-lg btn-primary" onclick="limitLoadedData(4)">Latest 4 posts</a>
			<a href="#" class="btn btn-lg" onclick="limitLoadedData(16)">Latest 16 posts</a>
		</div>
		<div class="row" style="display: none;" >
			<div class="col-md-4">
				<h4>Header</h4>
				<p>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
					consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
				</p>
			</div>
			<div class="col-md-4">
				<h4>Header</h4>
				<p>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
					consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
				</p>
			</div>
			<div class="col-md-4">
				<h4>Header</h4>
				<p>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
					consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
				</p>
			</div>
		</div>
		<hr>
		<div class="row">
			<div class="col-md-12">
				<a href="http://under-crage.blogspot.com/">
					<h2>Improbus</h2>
				</a>
			</div>
		</div>
		<div id="blogspot-feed">
		</div>
		
		<hr>
		<div class="row">
			<div class="col-md-12">
				<a href="http://under-crage.blogspot.com/">
					<h2>Facebook</h2>
				</a>
			</div>
		</div>
		<div id="facebook-feed">
		</div>

		<hr>
		<div class="row">
			<div class="col-md-12">
				<a href="http://instagram.com/bajograce">
					<h2>Instagram</h2>
				</a>
			</div>
		</div>
		<div id="instagram-feed">
		</div>
		
		<div class="clear"></div>
		<hr>
		<small>Darren Sapalo. Copyright 2016.</small>
		<div class="clear"></div>
	</div>

	<script type="text/javascript">
		window.checkImage = function(entry, tokens) { 
			window.value = entry;
			if (entry.content.includes('img'))
			{

				var idx = entry.content.indexOf('<img')
				var remaining = entry.content.substr(idx)
				var url_idx = remaining.indexOf('src=')
				var url = remaining.substr(url_idx + 5)
				url = url.substr(0, url.indexOf('\"'))
				return '<img class="img-responsive images" src="' + url + '"><BR />';
			}
			return '';
		}


		window.loadData = function() {


			var blogspotUrl = "http://under-crage.blogspot.com/feeds/posts/default?alt=rss";
			$("#blogspot-feed").html('');
			$("#blogspot-feed").rss(blogspotUrl, {
				layoutTemplate: "<div class='row'>{entries}</div>",
				tokens: {
					checkImage: checkImage
				},
				limit: +params['limit'] || 4,
				entryTemplate: '<div class="col-md-3">{checkImage}<h3>{title}</h3> <a href="{url}">{date}</a><BR /><p>{shortBodyPlain}</p></div>',
			})

			var facebookUrl = 'https://fbrss.com/feed/d5589adeb1bd17dcfe308985dc04480fb8d7140a.xml'
			$("#facebook-feed").html('');
			$("#facebook-feed").rss(facebookUrl, {
				layoutTemplate: "<div class='row'>{entries}</div>",
				tokens: {
					checkImage: checkImage
				},
				limit: +params['limit'] || 4,
				entryTemplate: '<div class="col-md-3"><a href="{url}">{date}</a><BR />{checkImage}<p>{shortBodyPlain}</p></div>',
			})



			var instagramUrl = 'http://rssbridge.buddylist.co/?action=display&bridge=InstagramBridge&u=bajograce&format=MrssFormat';
			$("#instagram-feed").html('');
			$("#instagram-feed").rss(instagramUrl, {
				layoutTemplate: "<div class='row'>{entries}</div>",
				tokens: {
					checkImage: checkImage
				},
				limit: +params['limit'] || 4,
				entryTemplate: '<div class="col-md-3"><a href="{url}">{date}</a><img class="img-responsive" src="{teaserImageUrl}"><BR /></div>',
			})

		}

		$(document).ready(window.loadData)
		window.limitLoadedData = function(limit){
			params['limit'] = +limit;
			window.loadData();
		}

	</script>
</body>
</html>